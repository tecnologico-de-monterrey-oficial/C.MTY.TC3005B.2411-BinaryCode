<div [class]="descripcionVisible ? 'card' : 'card-no-description'">
    <div
        class="image-container"
        [ngStyle]="{
            'background-image': 'url(' + proyecto.imagen + ')',
            'border-color': proyecto.color
        }">
        <div
            class="fondo-color"
            [ngStyle]="{
                'background-color': proyecto.color
            }">
            <div class="options-button">
                <a nz-dropdown nzTrigger="click" [nzDropdownMenu]="menu">
                    <span nz-icon nzType="more" nzTheme="outline"></span>
                </a>
                <nz-dropdown-menu #menu="nzDropdownMenu">
                    <ul nz-menu nzSelectable>
                        <li nz-menu-item (click)="abrirActualizarModal()">
                            Editar
                            <span
                                class="icono-opcion"
                                nz-icon
                                nzType="edit"></span>
                        </li>
                        <li
                            nz-menu-item
                            (click)="
                                proyecto.activo
                                    ? abrirArchivarModal()
                                    : abrirActivarModal()
                            ">
                            {{ proyecto.activo ? 'Archivar' : 'Activar' }}
                            <span
                                class="icono-opcion"
                                nz-icon
                                nzType="folder-open"></span>
                        </li>
                        <a
                            nz-menu-item
                            href="/permisos/proyecto/{{ proyecto.id }}">
                            Permisos
                            <span
                                class="icono-opcion"
                                nz-icon
                                nzType="unlock"></span>
                        </a>
                        <li nz-menu-item nzDanger (click)="abrirBorrarModal()">
                            Borrar
                            <span
                                class="icono-opcion icono-borrar"
                                nz-icon
                                nzType="delete"></span>
                        </li>
                    </ul>
                </nz-dropdown-menu>
            </div>
        </div>
    </div>
    <a href="/proyectos/{{ proyecto.id }}/unidades">
        <div
            [class]="descripcionVisible ? 'name-label' : 'name-label-center'"
            [ngStyle]="{ color: proyecto.color }">
            {{ proyecto.nombre }}
        </div>
    </a>
    <div class="description" *ngIf="descripcionVisible">
        {{ proyecto.descripcion }}
    </div>
</div>

<nz-modal
    class="modal-borrar"
    [(nzVisible)]="borrarVisible"
    [nzContent]="modalBorrarContent"
    [nzFooter]="null"
    (nzOnCancel)="cerrarModales()"
    [nzClosable]="false">
    <ng-template #modalBorrarContent>
        <app-micelaneos-modal-borrar-input
            [entrada]="textoBorrarProyecto"
            [nombre]="proyecto.nombre"
            (okModal)="handleBorrar($event)"
            (cancelModal)="cerrarModales()" />
    </ng-template>
</nz-modal>

<nz-modal
    [(nzVisible)]="archivarVisible"
    [nzContent]="modalArchivarContent"
    [nzFooter]="null"
    (nzOnCancel)="cerrarModales()"
    [nzClosable]="false">
    <ng-template #modalArchivarContent>
        <app-micelaneos-modal-generico
            [entrada]="textoArchivarProyecto"
            (okModal)="handleArchivar($event)"
            (cancelModal)="cerrarModales()" />
    </ng-template>
</nz-modal>

<nz-modal
    [(nzVisible)]="activarVisible"
    [nzContent]="modalActivarContent"
    [nzFooter]="null"
    (nzOnCancel)="cerrarModales()"
    [nzClosable]="false">
    <ng-template #modalActivarContent>
        <app-micelaneos-modal-generico
            [entrada]="textoActivarProyecto"
            (okModal)="handleActivar($event)"
            (cancelModal)="cerrarModales()" />
    </ng-template>
</nz-modal>

<nz-modal
    [(nzVisible)]="actualizarVisible"
    [nzContent]="modalActualizarContent"
    [nzFooter]="null"
    [nzClosable]="false"
    (nzOnCancel)="cerrarModales()"
    [nzWidth]="1380">
    <ng-template #modalActualizarContent>
        <app-proyectos-crear-modal
            [loading]="isLoading"
            (cancelModal)="cerrarModales()"
            (actualizarProyectoImportado)="
                handleActualizar($event.proyecto, $event.funcion)
            "
            [proyectoOriginal]="proyecto" />
    </ng-template>
</nz-modal>
