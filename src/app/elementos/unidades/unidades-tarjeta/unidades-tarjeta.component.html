<div class="card">
    <a href="{{ urlReferencia }}">
        <img
            class="image-container"
            [src]="unidad.imagen"
            (error)="handleImageError()"
            [ngStyle]="{ 'border-color': unidad.color }"
            *ngIf="!showPlaceholder"
            alt="Imagen de unidad" />
        <nz-empty
            class="image-container"
            [ngStyle]="{ 'border-color': unidad.color }"
            nzNotFoundImage="simple"
            *ngIf="showPlaceholder"
            [nzNotFoundContent]="contentTpl">
            <ng-template #contentTpl
                >Hubo un problema cargando la imagen</ng-template
            >
        </nz-empty>
    </a>
    <div class="options-button">
        <a nz-dropdown nzTrigger="click" [nzDropdownMenu]="menu">
            <span nz-icon nzType="more" nzTheme="outline"></span>
        </a>
        <nz-dropdown-menu #menu="nzDropdownMenu">
            <ul nz-menu nzSelectable>
                <li nz-menu-item (click)="showActualizarModal()">
                    Editar
                    <span class="icono-opcion" nz-icon nzType="edit"></span>
                </li>
                <a nz-menu-item href="/permisos/unidad/{{ unidad.id }}">
                    Permisos
                    <span class="icono-opcion" nz-icon nzType="unlock"></span>
                </a>
                <li nz-menu-item nzDanger (click)="showBorrarModal()">
                    Borrar
                    <span
                        class="icono-opcion icono-borrar"
                        nz-icon
                        nzType="delete"></span>
                </li>
            </ul>
        </nz-dropdown-menu>
    </div>
    <a href="{{ urlReferencia }}">
        <div class="name-label" [ngStyle]="{ color: unidad.color }">
            {{ unidad.nombre }}
        </div>
    </a>
</div>

<nz-modal
    class="modal-borrar"
    [(nzVisible)]="borrarVisible"
    [nzContent]="modalBorrarContent"
    [nzFooter]="null"
    (nzOnCancel)="handleCancel()"
    [nzClosable]="false">
    <ng-template #modalBorrarContent>
        <app-micelaneos-modal-borrar-input
            [loading]="isLoading"
            [entrada]="textoBorrarUnidad"
            [nombre]="unidad.nombre"
            (okModal)="handleDelete($event)"
            (cancelModal)="handleCancel()" />
    </ng-template>
</nz-modal>

<nz-modal
    [(nzVisible)]="actualizarVisible"
    [nzContent]="modalActualizarContent"
    [nzFooter]="null"
    [nzClosable]="false"
    (nzOnCancel)="handleCancel()"
    [nzWidth]="1380">
    <ng-template #modalActualizarContent>
        <app-unidades-crear-modal
            [loading]="isLoading"
            (cancelModal)="handleCancel()"
            (actualizarUnidadImportada)="
                handleActualizar($event.unidad, $event.funcion)
            "
            [unidadOriginal]="unidad" />
    </ng-template>
</nz-modal>
